<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="ä½ å¥½ï¼Œæˆ‘æ˜¯ç±³æ­ï¼Œæ­¡è¿ä¾†åˆ°æˆ‘çš„éƒ¨è½æ ¼:)"><meta property="og:title" content="MMiooiMM"><meta property="og:description" content="ä½ å¥½ï¼Œæˆ‘æ˜¯ç±³æ­ï¼Œæ­¡è¿ä¾†åˆ°æˆ‘çš„éƒ¨è½æ ¼:)"><meta property="og:image" content="https://raw.githubusercontent.com/MMiooiMM/MMiooiMM.github.io/master/images/VeryImportantFile.jpg"><title>.NET ç™¼ä½ˆå–®ä¸€åŸ·è¡Œæª” | MMiooiMM</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><link rel="stylesheet" type="text/css" href="/css/mio.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Hexo 4.2.1"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Archives</a><a class="sidebar-nav-item" href="/about">About</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-link" href="/tags/NET/" rel="tag">.NET</a></div><div class="post-time">2022-07-09</div></div></div><div class="container post-header"><h1>.NET ç™¼ä½ˆå–®ä¸€åŸ·è¡Œæª”</h1></div><div class="container post-content"><p>ConsoleApp å¦‚æœè¦ç™¼ä½ˆå–®ä¸€åŸ·è¡Œæª”ï¼Œåªéœ€è¦å¦‚ä¸‹åœ–å‹¾é¸ â€œProduce Single Fileâ€ å³å¯</p>
<p><img src="/images/2022-07-09/produce-single-file.png" alt="å‹¾é¸ Produce Single File ç•«é¢"></p>
<p>ä½†æˆ‘æ²’æœ‰åœ–ç‰‡ä¸Šçš„åŠŸèƒ½ğŸ˜¥ğŸ˜¥ï¼Œæ‰€ä»¥æ‰æœƒå¯«é€™ä¸€ç¯‡æ–‡ç« ç­†è¨˜ã€‚(åœ–ç‰‡ä¾†è‡ªæ–¼ <a href="https://stackoverflow.com/questions/69926447/publishing-c-sharp-console-app-as-a-stand-alone-executable" target="_blank" rel="noopener">Publishing C# Console App as a stand-alone executable</a>ï¼Œå°è±¡ä¸­ä¹Ÿçœ‹éè©²é¸é …)</p>
<p>çœ¾æ‰€çš†çŸ¥ï¼Œæ‰€æœ‰çš„ä½¿ç”¨è€…æ“ä½œä»‹é¢ï¼ŒèƒŒå¾Œéƒ½æ˜¯ä¸€æ¢æ¢æŒ‡ä»¤ï¼Œåªéœ€è¦ä¸‹é”æ­£ç¢ºçš„å‘½ä»¤ä¹Ÿå¯ä»¥åŸ·è¡Œé æœŸçš„è¡Œç‚ºã€‚</p>
<p>äº†è§£æŒ‡ä»¤æœ€å¿«çš„æ–¹å¼å°±æ˜¯æŸ¥æ‰¾å®˜æ–¹æ–‡ä»¶ï¼Œ<a href="https://docs.microsoft.com/en-us/dotnet/core/deploying/single-file/overview?tabs=cli" target="_blank" rel="noopener">Single-file deployment and executable</a> å°±èªªæ˜äº†è©²å¦‚ä½•ç™¼ä½ˆå–®ä¸€åŸ·è¡Œæª”ã€‚</p>
<ol>
<li>åœ¨ csproj æª”è£¡é¢æ·»åŠ </li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">PropertyGroup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">PublishSingleFile</span>&gt;</span>true<span class="tag">&lt;/<span class="name">PublishSingleFile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">PropertyGroup</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åŸ·è¡Œ <code>dotnet publish</code> ç™¼ä½ˆæ™‚å¢åŠ  <code>-r &lt;RID&gt;</code> åƒæ•¸ä¾†æŒ‡å®š runtime</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotnet publish -r win-x64</span><br></pre></td></tr></table></figure>

<p>å¦‚æœåŸ·è¡Œç’°å¢ƒæœ¬èº«è£æœ‰ runtimeï¼Œå¯ä»¥é€é <code>--sc|--self-contained [true|false]</code> åƒæ•¸ä½¿ç™¼ä½ˆæ™‚ä¸å¸¶æœ‰ runtimeï¼Œè®“ç¨‹å¼è®Šå¾—æ›´è¼•å·§(æ­¤åƒæ•¸é è¨­ç‚º <code>true</code>)ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dotnet publish -r win-x64 --self-contained false</span><br><span class="line">dotnet publish -r win-x64 --no-self-contained &#x2F;&#x2F; èˆ‡å‰è€…ç›¸ç­‰</span><br></pre></td></tr></table></figure>

<p>è‹¥ä¸æƒ³è¦åœ¨ csproj æª”æ¡ˆè¨­å®šï¼Œä¹Ÿå¯ä»¥é€™æ¨£ä¸€æ­¥åˆ°ä½</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotnet publish -r win-x64 -p:PublishSingleFile&#x3D;true --self-contained false</span><br></pre></td></tr></table></figure>

<p>è‹¥å° <code>dotnet publish</code> æŒ‡ä»¤æ„Ÿèˆˆè¶£å¯ä»¥è‡ªè¡Œé–±è®€ <a href="https://docs.microsoft.com/zh-tw/dotnet/core/tools/dotnet-publish" target="_blank" rel="noopener">dotnet publish</a>ã€‚</p>
<ol start="3">
<li>åŸ·è¡Œå¾Œå°±åªæœƒç”¢ç”Ÿ exe èˆ‡ pdb æª”æ¡ˆ</li>
</ol>
<p>é€™æ™‚å¦‚æœä¸æƒ³è¦ç”¢ç”Ÿ pdb æª”æ¡ˆè©²æ€éº¼è¾¦ï¼Ÿä¸€æ¨£å¯ä»¥é€é csproj è¨­å®šè™•ç†</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">DebugType</span>&gt;</span>embedded<span class="tag">&lt;/<span class="name">DebugType</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ·»åŠ å®Œç•¢å¾Œï¼Œå°±æœƒå°‡ pdb åˆä½µè‡³ exe è£¡é¢äº†ã€‚äº†è§£æ›´å¤šå¯è‡³ <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/compiler-options/code-generation" target="_blank" rel="noopener">C# Compiler Options that control code generation</a> èˆ‡é»‘æš—å¤§çš„æ–‡ç«  <a href="https://blog.darkthread.net/blog/about-dotnet-pdb/" target="_blank" rel="noopener">.NET çŸ¥è­˜é«˜è£æª¢ - .pdb æª”ã€ç·¨è­¯æœ€ä½³åŒ–èˆ‡åµéŒ¯</a>ã€‚</p>
<p>é€™æ¨£æˆ‘å€‘ <code>publish</code> å‡ºä¾†çš„çµæœå°±æœƒæ˜¯å–®ä¸€åŸ·è¡Œæª”å›‰ï¼Œå¯å–œå¯è³€ğŸ¥³ğŸ¥³</p>
</div></div><div class="post-main post-comment"><div id="disqus_thread"></div><script type="text/javascript">
var disqus_shortname = 'mio-blog';
var disqus_identifier = '2022/07/09/2022-07-09-dotnet-publish-single-file/';
var disqus_title = '.NET ç™¼ä½ˆå–®ä¸€åŸ·è¡Œæª”';
var disqus_url = 'http://yoursite.com/2022/07/09/2022-07-09-dotnet-publish-single-file/';
(function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" target="_blank" rel="noopener" class="dsq-brlink">Blog comments powered by <span class="logo-disqus">Disqus</span></a></div></article><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
e=o.createElement(i);r=o.getElementsByTagName(i)[0];
e.src='//www.google-analytics.com/analytics.js';
r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
ga('create','UA-156431110-1');ga('send','pageview');</script></body></html>