<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="你好，我是米歐，歡迎來到我的部落格:)"><meta property="og:title" content="MMiooiMM"><meta property="og:description" content="你好，我是米歐，歡迎來到我的部落格:)"><meta property="og:image" content="https://raw.githubusercontent.com/MMiooiMM/MMiooiMM.github.io/master/images/VeryImportantFile.jpg"><title>.NET 後端起手式 30天認識 C# - Day 14 類別(三) | MMiooiMM</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><link rel="stylesheet" type="text/css" href="/css/mio.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Hexo 4.2.1"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Archives</a><a class="sidebar-nav-item" href="/about">About</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-link" href="/tags/2019-iT-%E9%82%A6%E5%B9%AB%E5%BF%99%E9%90%B5%E4%BA%BA%E8%B3%BD/" rel="tag">2019 iT 邦幫忙鐵人賽</a><a class="post-tag-link" href="/tags/CSharp/" rel="tag">CSharp</a></div><div class="post-time">2018-10-24</div></div></div><div class="container post-header"><h1>.NET 後端起手式 30天認識 C# - Day 14 類別(三)</h1></div><div class="container post-content"><h2 id="DAY-14-類別-三"><a href="#DAY-14-類別-三" class="headerlink" title="DAY 14 類別(三)"></a>DAY 14 類別(三)</h2><h3 id="類別"><a href="#類別" class="headerlink" title="類別"></a>類別</h3><p>上次講的類別都屬於參考型別，今天會介紹實質型別的類別，如果忘記型別差異的話，可以回去看第二天的文章。</p>
<h3 id="結構-struct"><a href="#結構-struct" class="headerlink" title="結構 struct"></a>結構 struct</h3><blockquote>
<p>結構包含建構函式、常數、欄位、方法、屬性、索引子、運算子、事件和巢狀型別，不過如果需要數個這類成員，您應該考慮以類別來取代類型。</p>
</blockquote>
<p>結構的用法與 class 相似，但結構使用時，無法初始化屬性，在下方用 class 示範如何初始化屬性</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Program</span> &#123;</span><br><span class="line">  <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span> (<span class="params"><span class="keyword">string</span>[] args</span>)</span> &#123;</span><br><span class="line">    Member member = <span class="keyword">new</span> Member (<span class="number">1</span>, <span class="string">"Mio"</span>);</span><br><span class="line">    member.Print ();</span><br><span class="line">    Memberc memberc = <span class="keyword">new</span> Memberc ();</span><br><span class="line">    memberc.Print ();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> Member &#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Member</span> (<span class="params"><span class="keyword">int</span> id, <span class="keyword">string</span> name</span>)</span> &#123;</span><br><span class="line">    ID = id;</span><br><span class="line">    Name = name;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">int</span> ID &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">string</span> Name &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Print</span> (<span class="params"></span>)</span> &#123;</span><br><span class="line">    Console.WriteLine (<span class="string">$"ID: <span class="subst">&#123;id&#125;</span>, Name: <span class="subst">&#123;name&#125;</span>"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Memberc</span> &#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Memberc</span> (<span class="params"></span>)</span> &#123; &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Memberc</span> (<span class="params"><span class="keyword">int</span> id, <span class="keyword">string</span> name</span>)</span> &#123;</span><br><span class="line">    ID = id;</span><br><span class="line">    Name = name;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">int</span> ID &#123; <span class="keyword">get</span>; &#125; = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">string</span> Name &#123; <span class="keyword">get</span>; &#125; = <span class="string">"Mio"</span>;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Print</span> (<span class="params"></span>)</span> &#123;</span><br><span class="line">    Console.WriteLine (<span class="string">$"ID: <span class="subst">&#123;ID&#125;</span>, Name: <span class="subst">&#123;Name&#125;</span>"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>也就是當今天沒有傳入任何參數時，則會預設是 ID = 0, Name = Mio，隨便舉例而已。get 是存取子，還有一個是 set，如果只有 get 就是唯讀，只有 set 就是唯寫，詳細操作可以看下方連結。</p>
<p>結構往往是用在不可變的狀態下，像範例中的屬性成員是唯讀的，不能去修改。</p>
<h3 id="列舉"><a href="#列舉" class="headerlink" title="列舉"></a>列舉</h3><blockquote>
<p>包含一組稱為列舉程式清單之具名常數的不同類型</p>
</blockquote>
<p>以資料庫連線狀態來舉例，假設連線狀態有未連接、嘗試連接與連接中三種狀態</p>
<p>如果不使用列舉，我們稱狀態為 0, 1, 2</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> connectionState;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">switch</span> (connectionState) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用列舉後</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ConnectionState connectionState;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">switch</span> (connectionState) &#123;</span><br><span class="line">  <span class="keyword">case</span> connectionState.Disconnected:</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> connectionState.Connecting:</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> connectionState.Connected:</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可讀性是不是差很多呢？兩者在運行時效能完全一樣，列舉的關鍵在於編譯時能宣告一組可以透過名稱來使用的整數值</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> ConnectionState &#123;</span><br><span class="line">  Disconnected,</span><br><span class="line">  Connecting,</span><br><span class="line">  Connected</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在使用時，需要加入列舉名稱前綴如<code>ConnectionState.Connected</code>，如果沒有任何預設值的話，列舉的數值從 0 開始排，也就是說</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span> (<span class="params"><span class="keyword">string</span>[] args</span>)</span> &#123;</span><br><span class="line">  Console.WriteLine (<span class="string">$"Name = <span class="subst">&#123;MyEnum.A&#125;</span>, Value = <span class="subst">&#123;(<span class="keyword">int</span>)MyEnum.A&#125;</span>"</span>);</span><br><span class="line">  Console.WriteLine (<span class="string">$"Name = <span class="subst">&#123;MyEnum.B&#125;</span>, Value = <span class="subst">&#123;(<span class="keyword">int</span>)MyEnum.B&#125;</span>"</span>);</span><br><span class="line">  Console.WriteLine (<span class="string">$"Name = <span class="subst">&#123;MyEnum.C&#125;</span>, Value = <span class="subst">&#123;(<span class="keyword">int</span>)MyEnum.C&#125;</span>"</span>);</span><br><span class="line">  Console.ReadKey ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">enum</span> MyEnum &#123;</span><br><span class="line">  A,</span><br><span class="line">  B,</span><br><span class="line">  C</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但如果今天加入預設值後</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span> (<span class="params"><span class="keyword">string</span>[] args</span>)</span> &#123;</span><br><span class="line">  Console.WriteLine (<span class="string">$"Name = <span class="subst">&#123;MyEnum.A&#125;</span>, Value = <span class="subst">&#123;(<span class="keyword">int</span>)MyEnum.A&#125;</span>"</span>);</span><br><span class="line">  Console.WriteLine (<span class="string">$"Name = <span class="subst">&#123;MyEnum.B&#125;</span>, Value = <span class="subst">&#123;(<span class="keyword">int</span>)MyEnum.B&#125;</span>"</span>);</span><br><span class="line">  Console.WriteLine (<span class="string">$"Name = <span class="subst">&#123;MyEnum.C&#125;</span>, Value = <span class="subst">&#123;(<span class="keyword">int</span>)MyEnum.C&#125;</span>"</span>);</span><br><span class="line">  Console.WriteLine (<span class="string">$"Name = <span class="subst">&#123;MyEnum.D&#125;</span>, Value = <span class="subst">&#123;(<span class="keyword">int</span>)MyEnum.D&#125;</span>"</span>);</span><br><span class="line">  Console.WriteLine (<span class="string">$"Name = <span class="subst">&#123;MyEnum.E&#125;</span>, Value = <span class="subst">&#123;(<span class="keyword">int</span>)MyEnum.E&#125;</span>"</span>);</span><br><span class="line">  Console.ReadKey ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">enum</span> MyEnum &#123;</span><br><span class="line">  A,</span><br><span class="line">  B = <span class="number">8</span>,</span><br><span class="line">  C = <span class="number">6</span>,</span><br><span class="line">  D,</span><br><span class="line">  E</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以自己玩玩看，列舉不是只有 int 而已，也可以宣告成 short 如</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> MyEnum : <span class="keyword">short</span> &#123;</span><br><span class="line">  A,</span><br><span class="line">  B = <span class="number">8</span>,</span><br><span class="line">  C = <span class="number">6</span>,</span><br><span class="line">  D,</span><br><span class="line">  E</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>除了像是這種分開的狀態外，也會使用在可疊加狀態的，像是一個標誌來使用，以 System.IO.FileAttributes 舉例</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">Flags</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> FileAttributes</span><br><span class="line">&#123;</span><br><span class="line">  ReadOnly = <span class="number">1</span>, <span class="comment">// 1 &lt;&lt; 0  0000001   </span></span><br><span class="line">  Hidden = <span class="number">2</span>,   <span class="comment">// 1 &lt;&lt; 1  0000010</span></span><br><span class="line">  System = <span class="number">4</span>,   <span class="comment">// 1 &lt;&lt; 2  0000100</span></span><br><span class="line">  Directory = <span class="number">8</span>,<span class="comment">// 1 &lt;&lt; 3  0001000</span></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   * 以下省略</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>題外話：在設定初始值時，也可以像右邊的移位運算子(&lt;&lt;)，會比較整齊。</p>
<p>這種列舉可以想成是二進位的加減，當你今天需要多重狀態時，就可以使用 OR 運算子來疊加，假設我今天需要前面兩種狀態的話，如</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span> (<span class="params"><span class="keyword">string</span>[] args</span>)</span> &#123;</span><br><span class="line">  System.IO.FileAttributes FA = System.IO.FileAttributes.Hidden | System.IO.FileAttributes.ReadOnly;</span><br><span class="line">  Console.WriteLine (<span class="string">$"Name = <span class="subst">&#123;FA&#125;</span>, Value = <span class="subst">&#123;(<span class="keyword">int</span>)FA&#125;</span>"</span>);</span><br><span class="line">  Console.ReadKey ();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到名稱很完整的印出了每個狀態，因為在使用這個列舉時有加一個 Attribute(屬性) <code>[Flags]</code>，可以自己撰寫一個以二進位方式的列舉，加入這個屬性來看差異。</p>
<p>題外話：雖然中文都翻屬性，但我覺得有時候講起來很容易混淆，不知道有沒有路過的大大可以提通我更好的中文字詞。</p>
<h3 id="一些小結論"><a href="#一些小結論" class="headerlink" title="一些小結論"></a>一些小結論</h3><p>今天把實質型別的類別做了個大概，本來在實務上是很少使用結構的，都是使用 class 類別來取代，所以在說類別時，往往就是指 class 了。而列舉就比較容易遇到，因為可以讓程式碼在讀的時候比較好懂。</p>
<p>感謝閱讀。</p>
<p>參考連結<br><a href="https://docs.microsoft.com/zh-tw/dotnet/csharp/language-reference/keywords/struct" target="_blank" rel="noopener">struct (C# 參考) | Microsoft Docs</a><br><a href="https://docs.microsoft.com/zh-tw/dotnet/csharp/language-reference/keywords/get" target="_blank" rel="noopener">get (C# 參考) | Microsoft Docs</a><br><a href="https://docs.microsoft.com/zh-tw/dotnet/csharp/language-reference/keywords/enum" target="_blank" rel="noopener">enum 關鍵字 (C# 參考) | Microsoft Docs</a></p>
</div></div><div class="post-main post-comment"><div id="disqus_thread"></div><script type="text/javascript">
var disqus_shortname = 'mio-blog';
var disqus_identifier = '2018/10/24/2018-10-24-learn-csharp-in-30-days-14/';
var disqus_title = '.NET 後端起手式 30天認識 C# - Day 14 類別(三)';
var disqus_url = 'http://yoursite.com/2018/10/24/2018-10-24-learn-csharp-in-30-days-14/';
(function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" target="_blank" rel="noopener" class="dsq-brlink">Blog comments powered by <span class="logo-disqus">Disqus</span></a></div></article><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
e=o.createElement(i);r=o.getElementsByTagName(i)[0];
e.src='//www.google-analytics.com/analytics.js';
r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
ga('create','UA-156431110-1');ga('send','pageview');</script></body></html>